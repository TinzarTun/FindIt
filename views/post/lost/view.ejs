<!-- Main Content -->
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
  <!-- Header Section -->
  <div class="mb-8">
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
      <div>
        <h1 class="text-3xl font-bold text-gray-900">Lost Items</h1>
        <p class="text-gray-600 mt-2">Help us find these missing items</p>
      </div>
      <div class="mt-4 sm:mt-0">
        <a
          href="/lost/create"
          class="bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 font-medium flex items-center"
        >
          <i data-lucide="plus" class="h-5 w-5 mr-2"></i>
          Report Lost Item
        </a>
      </div>
    </div>
  </div>
  <!-- Filters and Search -->
  <div class="bg-white rounded-lg shadow-sm border p-6 mb-6">
    <form action="/lost" method="get">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <!-- Search -->
        <div>
          <label
            for="search"
            class="block text-sm font-medium text-gray-700 mb-2"
            >Search</label
          >
          <div class="relative">
            <i
              data-lucide="search"
              class="absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"
            ></i>
            <input
              type="text"
              id="search"
              name="search"
              placeholder="Search lost items..."
              value="<%= search || '' %>"
              class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500"
            />
          </div>
        </div>
        <!-- Category -->
        <div>
          <label
            for="category"
            class="block text-sm font-medium text-gray-700 mb-2"
            >Category</label
          >
          <select
            id="category"
            name="category"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500"
          >
            <option value="">All Categories</option>
            <% categories.forEach(category => { %>
            <option value="<%= category.id %>" <%= category.id === selectedCategory ? 'selected' : '' %>>
              <%= category.name %>
            </option>
            <% }) %>
          </select>
        </div>
        <!-- Location -->
        <div>
          <label
            for="location"
            class="block text-sm font-medium text-gray-700 mb-2"
            >Location</label
          >
          <select
            id="location"
            name="location"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500"
          >
            <option value="">All Locations</option>
            <option value="downtown" <%= selectedLocation === 'downtown' ? 'selected' : '' %>>Downtown Yangon</option>
            <option value="north" <%= selectedLocation === 'north' ? 'selected' : '' %>>North Yangon</option>
            <option value="south" <%= selectedLocation === 'south' ? 'selected' : '' %>>South Yangon</option>
            <option value="east" <%= selectedLocation === 'east' ? 'selected' : '' %>>East Yangon</option>
            <option value="west" <%= selectedLocation === 'west' ? 'selected' : '' %>>West Yangon</option>
          </select>
        </div>
        <!-- Date Range -->
        <div>
          <label
            for="date-range"
            class="block text-sm font-medium text-gray-700 mb-2"
            >Date Range</label
          >
          <select
            id="date-range"
            name="dateRange"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500"
          >
            <option value="">All Time</option>
            <option value="today" <%= selectedDateRange === 'today' ? 'selected' : '' %>>Today</option>
            <option value="week" <%= selectedDateRange === 'week' ? 'selected' : '' %>>This Week</option>
            <option value="month" <%= selectedDateRange === 'month' ? 'selected' : '' %>>This Month</option>
            <option value="3months" <%= selectedDateRange === '3months' ? 'selected' : '' %>>Last 3 Months</option>
          </select>
        </div>
      </div>
      <!-- Buttons -->
      <div
        class="flex flex-col sm:flex-row sm:items-center sm:justify-between mt-4 pt-4 border-t"
      >
        <div class="flex items-center space-x-4">
          <button
            id="apply-filters"
            class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 font-medium"
            type="submit"
          >
            Apply Filters
          </button>
          <button
            id="clear-filters"
            class="text-gray-600 hover:text-gray-800 font-medium"
            type="button"
            onclick="window.location.href = '/lost'"
          >
            Clear All
          </button>
        </div>
        <div id="item-count" class="mt-4 sm:mt-0 text-sm text-gray-600">
          Showing <%= totalItems %> lost items
        </div>
      </div>
    </form>
  </div>
  <!-- Lost Items Grid -->
  <div
    id="lost-items-grid"
    class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
  >
    <% if (error) { %>
    <p class="col-span-full text-center text-red-600"><%= error %></p>
    <% } else if (lostItems.length === 0) { %>
    <p class="col-span-full text-center text-gray-600">No lost items found matching your criteria.</p>
    <% } else { %> <% lostItems.forEach(item => { %>
    <div
      class="bg-white rounded-lg border overflow-hidden transform transition-all duration-300 hover:scale-[1.02] hover:shadow-lg"
    >
      <div class="relative group">
        <div class="w-full h-48 bg-gray-100 overflow-hidden">
          <img
            src="<%= item.images && item.images.length > 0
              ? '/uploads/lost-items/' + item.images[0]
              : 'https://cdn-icons-png.flaticon.com/512/1829/1829586.png' %>"
            alt="<%= item.title %>"
            class="object-cover w-full h-full transition-transform duration-300 group-hover:scale-105"
          />
        </div>
        <div class="absolute top-3 left-3 space-y-1">
          <% if (item.featured) { %>
          <span
            class="flex items-center text-white text-xs font-medium bg-purple-500 px-2 py-0.5 rounded-full"
          >
            <i data-lucide="star" class="w-3 h-3 mr-1"></i> Featured
          </span>
          <% } %>
        </div>
        <% if (item.reward) { %>
        <div class="absolute top-3 right-3">
          <span
            class="bg-yellow-500 text-white text-xs font-medium px-2 py-1 rounded-full"
          >
            $<%= item.reward.toFixed(2) %> Reward
          </span>
        </div>
        <% } %>
      </div>
      <div class="p-4">
        <div class="flex justify-between items-center mb-1">
          <span
            class="bg-red-200 text-red-800 text-xs font-medium px-2.5 py-0.5 rounded"
          >
            <%= item.status %>
          </span>
          <span class="text-sm text-gray-500 flex items-center">
            <i data-lucide="calendar" class="h-4 w-4 mr-1"></i>
            <%= new Date(item.lostDate).toLocaleDateString("en-US", { month:
            "short", day: "numeric", year: "numeric", }) %>
          </span>
        </div>
        <h3
          class="text-lg font-semibold text-gray-900 mb-2 flex items-center space-x-2"
        >
          <span><%= item.title %></span>
        </h3>
        <p class="text-gray-600 text-sm mb-3"><%= item.description %></p>
        <div
          class="flex items-center justify-between text-sm text-gray-500 mb-3"
        >
          <span class="flex items-center">
            <i data-lucide="map-pin" class="h-4 w-4 mr-1"></i>
            <%= item.lostLocation %>
          </span>
        </div>
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-2">
            <img
              src="<%= item.user.avatar 
                ? '/avatar/' + item.user.avatar 
                : 'https://cdn-icons-png.flaticon.com/512/847/847969.png' %>"
              alt="<%= item.user.name %>"
              class="w-6 h-6 rounded-full object-cover"
            />

            <span class="text-sm text-gray-600"><%= item.user.name %></span>
          </div>
          <a
            href="/lost/<%= item.id %>"
            class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 text-sm font-medium"
          >
            View Details
          </a>
        </div>
      </div>
    </div>
    <% }) %> <% } %>
  </div>

  <!-- Pagination -->
  <div class="flex items-center justify-between mt-8">
    <div id="pagination-summary" class="text-sm text-gray-600">
      Showing <%= startItem %> to <%= endItem %> of <%= totalItems %>
      results
    </div>

      <% if (totalPages > 1 || lostItems.length === 0) { %>
      <div class="flex items-center space-x-2">
        <!-- Prev button -->
        <a
          href="?page=<%= currentPage - 1 %>&<%= queryString %>"
          class="px-3 py-2 border border-gray-300 rounded-lg text-gray-600 hover:bg-gray-50 <%= currentPage === 1 ? 'opacity-50 pointer-events-none' : '' %>"
        >
          <i data-lucide="chevron-left" class="h-4 w-4"></i>
        </a>

        <% if (lostItems.length > 0) { %>
          <% for (let i = 1; i <= totalPages; i++) { %>
            <a
              href="?page=<%= i %>&<%= queryString %>"
              class="px-3 py-2 <%= i === currentPage ? 'bg-red-600 text-white' : 'border border-gray-300 rounded-lg text-gray-600 hover:bg-gray-50' %>"
            >
              <%= i %>
            </a>
          <% } %>
        <% } %>

        <!-- Next button -->
        <a
          href="?page=<%= currentPage + 1 %>&<%= queryString %>"
          class="px-3 py-2 border border-gray-300 rounded-lg text-gray-600 hover:bg-gray-50 <%= currentPage === totalPages ? 'opacity-50 pointer-events-none' : '' %>"
        >
          <i data-lucide="chevron-right" class="h-4 w-4"></i>
        </a>
      </div>
    <% } %>
  </div>
</div>
